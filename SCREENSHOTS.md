# Screenshots & Captions

![AWS IAM – Access key best practices & alternatives screen while creating an access key for a scoped user.](/images/aws-iam-access-key-best-practices.png)

*AWS IAM – Access key best practices & alternatives screen while creating an access key for a scoped user.*

![AWS IAM – Access key creation flow (retrieve keys). Used for programmatic access where required.](/images/aws-iam-access-key-retrieve.png)

*AWS IAM – Access key creation flow (retrieve keys). Used for programmatic access where required.*

![Azure Logic Apps – Microsoft Sentinel connector action catalog (add alert/comment/task, manage bookmarks).](/images/logic-apps-sentinel-actions.png)

*Azure Logic Apps – Microsoft Sentinel connector action catalog (add alert/comment/task, manage bookmarks).*

![Logic App playbook triggered by **Microsoft Sentinel alert** to automate response.](/images/logic-apps-sentinel-trigger.png)

*Logic App playbook triggered by **Microsoft Sentinel alert** to automate response.*

![Microsoft Sentinel – AWS S3 data connector configured with Role ARN & SQS queue for CloudTrail ingestion.](/images/sentinel-aws-s3-connector.png)

*Microsoft Sentinel – AWS S3 data connector configured with Role ARN & SQS queue for CloudTrail ingestion.*

![Sentinel Automation – condition builder for incident-based automation (scope to specific analytics rules).](/images/sentinel-automation-conditions.png)

*Sentinel Automation – condition builder for incident-based automation (scope to specific analytics rules).*

![Sentinel Automation Rule – assigns owner on incident creation (used for AWS failed logon incidents).](/images/sentinel-automation-rule.png)

*Sentinel Automation Rule – assigns owner on incident creation (used for AWS failed logon incidents).*

![AWS S3 – CloudTrail logs bucket (us-east-2) used as the landing zone for Sentinel ingestion.](/images/aws-s3-cloudtrail-bucket.png)

*AWS S3 – CloudTrail logs bucket (us-east-2) used as the landing zone for Sentinel ingestion.*

![AWS CloudTrail – trail configuration with multi‑region logging enabled; S3 path shown.](/images/aws-cloudtrail-trail-details.png)

*AWS CloudTrail – trail configuration with multi‑region logging enabled; S3 path shown.*

![Sentinel Content Hub – **Amazon Web Services** solution tile prior to installation.](/images/sentinel-content-hub-aws-solution.png)

*Sentinel Content Hub – **Amazon Web Services** solution tile prior to installation.*


## Additional screenshots
![AWS CloudTrail – Quick create multi‑region trail; notes S3 bucket path and cost note.](/images/aws-cloudtrail-quick-create.png)

*AWS CloudTrail – Quick create multi‑region trail; notes S3 bucket path and cost note.*
![Sentinel KQL – Summary of IAM `CreateUser` / `DeleteUser` events with target usernames.](/images/sentinel-kql-iam-create-delete.png)

*Sentinel KQL – Summary of IAM `CreateUser` / `DeleteUser` events with target usernames.*
![Azure Monitor – Creating a Data Collection Rule (DCR) for Windows to ship Security Events.](/images/azure-dcr-create-basics.png)

*Azure Monitor – Creating a Data Collection Rule (DCR) for Windows to ship Security Events.*
![Azure DCR – Destination set to Log Analytics workspace (SOC-LA WORKSPACE).](/images/azure-dcr-destination-workspace.png)

*Azure DCR – Destination set to Log Analytics workspace (SOC-LA WORKSPACE).*
![Microsoft Defender for Cloud – CSPM/Defender plan settings (trial + coverage).](/images/defender-for-cloud-plans.png)

*Microsoft Defender for Cloud – CSPM/Defender plan settings (trial + coverage).*
![AWS IAM – Delete users confirmation to generate CloudTrail management events.](/images/aws-iam-delete-users-confirm.png)

*AWS IAM – Delete users confirmation to generate CloudTrail management events.*
![Sentinel Analytics – Brute-force for failed logon attempts (Windows 4625) scheduled rule.](/images/sentinel-analytics-bruteforce-4625.png)

*Sentinel Analytics – Brute-force for failed logon attempts (Windows 4625) scheduled rule.*
![Endpoint lab – PowerShell `Invoke-WebRequest` to fetch Sysinternals TCPView (network artifact).](/images/endpoint-powershell-download-tcpview.png)

*Endpoint lab – PowerShell `Invoke-WebRequest` to fetch Sysinternals TCPView (network artifact).*
![Phishing lab – Email header review highlighting Gmail Return‑Path and Google mail servers.](/images/email-header-analysis.png)

*Phishing lab – Email header review highlighting Gmail Return‑Path and Google mail servers.*
![Sentinel KQL – Detect failed AWS `ConsoleLogin` events and aggregate by user.](/images/sentinel-kql-aws-consolelogin-failure.png)

*Sentinel KQL – Detect failed AWS `ConsoleLogin` events and aggregate by user.*


## More screenshots
![AWS Console – Authentication failed banner used to generate `ConsoleLogin` failure events.](/images/aws-console-auth-failed.png)

*AWS Console – Authentication failed banner used to generate `ConsoleLogin` failure events.*
![Sentinel KQL – ConsoleLogin grouped by status (Success/Failure) for quick validation of detections.](/images/sentinel-kql-consolelogin-success-failure.png)

*Sentinel KQL – ConsoleLogin grouped by status (Success/Failure) for quick validation of detections.*
![Sentinel Analytics – Scheduled rule: AWS IAM user created or deleted (from CloudTrail).](/images/sentinel-analytics-iam-create-delete.png)

*Sentinel Analytics – Scheduled rule: AWS IAM user created or deleted (from CloudTrail).*
![Azure Logic Apps – Designer view for an S3-triggered workflow to process CloudTrail drops.](/images/logic-app-designer-s3-trigger.png)

*Azure Logic Apps – Designer view for an S3-triggered workflow to process CloudTrail drops.*
![AWS IAM – Identity used by Logic Apps/Sentinel pipeline to read S3 (programmatic access only).](/images/aws-iam-logicapp-s3-reader.png)

*AWS IAM – Identity used by Logic Apps/Sentinel pipeline to read S3 (programmatic access only).*
![Azure – Create Logic App: hosting plan selection (Consumption vs Workflow Service Plan).](/images/create-logic-app-hosting-plan.png)

*Azure – Create Logic App: hosting plan selection (Consumption vs Workflow Service Plan).*
![AWS CloudTrail – Management events logging (Read/Write) enabled for the trail.](/images/aws-cloudtrail-management-events.png)

*AWS CloudTrail – Management events logging (Read/Write) enabled for the trail.*
![AWS IAM – New users created to simulate management activity for CloudTrail.](/images/aws-iam-users-created.png)

*AWS IAM – New users created to simulate management activity for CloudTrail.*
![Phishing lab – Email header (alt view) highlighting Return-Path and Google SMTP hops.](/images/email-header-analysis-v2.png)

*Phishing lab – Email header (alt view) highlighting Return-Path and Google SMTP hops.*
![Sentinel KQL – Additional view of failed `ConsoleLogin` aggregation by user.](/images/sentinel-kql-aws-consolelogin-failure-v2.png)

*Sentinel KQL – Additional view of failed `ConsoleLogin` aggregation by user.*


## Final batch
![Endpoint lab – Running `powershell.exe -Command "Get-Process"` to generate Windows 4688 process creation logs.](/images/endpoint-powershell-generate-4688.png)

*Endpoint lab – Running `powershell.exe -Command "Get-Process"` to generate Windows 4688 process creation logs.*
![Sentinel Detection Rules – 'Powershell events Generated' analytics rule configured (scheduled).](/images/sentinel-analytics-powershell-rule.png)

*Sentinel Detection Rules – 'Powershell events Generated' analytics rule configured (scheduled).*
![Detection Rules pane – PowerShell analytics rule enabled; events are being generated.](/images/sentinel-detection-rule-pane.png)

*Detection Rules pane – PowerShell analytics rule enabled; events are being generated.*
![Thunderbird – Phishing email impersonating Microsoft; 'Verify My Account' link present.](/images/thunderbird-phish-message.png)

*Thunderbird – Phishing email impersonating Microsoft; 'Verify My Account' link present.*
![Thunderbird – Alternate view of the phishing email with visible hover URL (non-Microsoft HTTP link).](/images/thunderbird-phish-message-alt.png)

*Thunderbird – Alternate view of the phishing email with visible hover URL (non-Microsoft HTTP link).*
![Thunderbird – .eml source showing raw HTML with link to accounts-security-checkup.com/login.php.](/images/eml-source-html-phish.png)

*Thunderbird – .eml source showing raw HTML with link to accounts-security-checkup.com/login.php.*
![Thunderbird – Phishing email view (alternate shot for documentation).](/images/thunderbird-phish-alt2.png)

*Thunderbird – Phishing email view (alternate shot for documentation).*
![Microsoft Sentinel – Add to workspace screen selecting SOC-LAWORKSPACE in East US.](/images/sentinel-add-to-workspace.png)

*Microsoft Sentinel – Add to workspace screen selecting SOC-LAWORKSPACE in East US.*
![Sentinel KQL – Windows logon successes/failures (EventID 4624/4625) with Computer, Account, LogonType.](/images/sentinel-kql-4624-4625.png)

*Sentinel KQL – Windows logon successes/failures (EventID 4624/4625) with Computer, Account, LogonType.*
![Sentinel KQL – Successful AWS `ConsoleLogin` with source IP and region details.](/images/sentinel-kql-consolelogin-success.png)

*Sentinel KQL – Successful AWS `ConsoleLogin` with source IP and region details.*


## URL enrichment & final setup
![AWS CloudTrail – Trail summary showing multi‑region logging and S3 path; validation of log delivery.](/images/aws-cloudtrail-trail-summary.png)

*AWS CloudTrail – Trail summary showing multi‑region logging and S3 path; validation of log delivery.*
![VirusTotal – URL analysis of the phishing link; crowd intelligence and vendor verdicts used as enrichment.](/images/virustotal-url-analysis.png)

*VirusTotal – URL analysis of the phishing link; crowd intelligence and vendor verdicts used as enrichment.*
![Azure DCR – Add data source: Windows Event Logs (Basic) to collect Application logs; connector guidance noted.](/images/azure-dcr-windows-event-logs.png)

*Azure DCR – Add data source: Windows Event Logs (Basic) to collect Application logs; connector guidance noted.*
